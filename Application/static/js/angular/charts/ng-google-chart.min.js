/*
 MIT
 @year 2013
*/
(function(m,p){function n(c,e){"loaded"==c.readyState||"complete"==c.readyState?e():setTimeout(function(){n(c,e)},100)}function q(c,e){var d=m.createElement("script");d.src=c;d.onload=e;d.onerror=function(){throw Error('Error loading "'+c+'"');};n(d,e);m.getElementsByTagName("head")[0].appendChild(d)}angular.module("googlechart",[]).constant("googleChartApiConfig",{version:"1",optionalSettings:{packages:["corechart"]}}).factory("googleChartApiProxy",["$rootScope","$q","googleChartApiConfig",function(c,
e,d){var l=e.defer();q("//www.google.com/jsapi",function(){var a={callback:function(){var a=d.optionalSettings.callback;c.$apply(function(){l.resolve()});angular.isFunction(a)&&a.call(this)}},a=angular.extend({},d.optionalSettings,a);p.google.load("visualization",d.version,a)});return function(a,c){var d=Array.prototype.slice.call(arguments,2);return function(){l.promise.then(function(){a.apply(c,d.concat(Array.prototype.slice.call(arguments)))})}}}]).directive("googleChart",["$timeout","$window",
"$rootScope","googleChartApiProxy",function(c,e,d,l){return{restrict:"A",scope:{chart:"=chart",onReady:"&",select:"&"},link:function(a,e,m){function k(b,c,d){if("undefined"!=typeof a.chart.formatters[b]){if(null==a.formatters[b])if(a.formatters[b]=[],"color"===b)for(var e=0;e<a.chart.formatters[b].length;e++){for(var h=new c,f=0;f<a.chart.formatters[b][e].formats.length;f++){var g=a.chart.formatters[b][e].formats[f];"undefined"!=typeof g.fromBgColor&&"undefined"!=typeof g.toBgColor?h.addGradientRange(g.from,
g.to,g.color,g.fromBgColor,g.toBgColor):h.addRange(g.from,g.to,g.color,g.bgcolor)}a.formatters[b].push(h)}else for(f=0;f<a.chart.formatters[b].length;f++)a.formatters[b].push(new c(a.chart.formatters[b][f]));for(f=0;f<a.formatters[b].length;f++)a.chart.formatters[b][f].columnNum<d.getNumberOfColumns()&&a.formatters[b][f].format(d,a.chart.formatters[b][f].columnNum);if("arrow"===b||"bar"===b||"color"===b)a.chart.options.allowHtml=!0}}function h(){h.triggered||void 0==a.chart||(h.triggered=!0,c(function(){h.triggered=
!1;"undefined"===typeof a.formatters&&(a.formatters={});var b;b=a.chart.data instanceof google.visualization.DataTable?a.chart.data:new google.visualization.DataTable(a.chart.data,0.5);"undefined"!=typeof a.chart.formatters&&(k("number",google.visualization.NumberFormat,b),k("arrow",google.visualization.ArrowFormat,b),k("date",google.visualization.DateFormat,b),k("bar",google.visualization.BarFormat,b),k("color",google.visualization.ColorFormat,b));var d={chartType:a.chart.type,dataTable:b,view:a.chart.view,
options:a.chart.options,containerId:e[0]};null==a.chartWrapper?(a.chartWrapper=new google.visualization.ChartWrapper(d),google.visualization.events.addListener(a.chartWrapper,"ready",function(){a.chart.displayed=!0;a.$apply(function(a){a.onReady({chartWrapper:a.chartWrapper})})}),google.visualization.events.addListener(a.chartWrapper,"error",function(a){console.log("Chart not displayed due to error: "+a.message)}),google.visualization.events.addListener(a.chartWrapper,"select",function(){var b=a.chartWrapper.getChart().getSelection()[0];
b&&a.$apply(function(){a.select({selectedItem:b})})})):(a.chartWrapper.setChartType(a.chart.type),a.chartWrapper.setDataTable(b),a.chartWrapper.setView(a.chart.view),a.chartWrapper.setOptions(a.chart.options));c(function(){a.chartWrapper.draw()})},0,!0))}a.$watch("chart",function(){h()},!0);d.$on("resizeMsg",function(b){c(function(){a.chartWrapper.draw()})});h=l(h,this)}}}]).run(["$rootScope","$window",function(c,e){angular.element(e).bind("resize",function(){c.$emit("resizeMsg")})}])})(document,
window);